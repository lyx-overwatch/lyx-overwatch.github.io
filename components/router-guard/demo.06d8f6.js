(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1418:function(n,s,a){n.exports={content:[["h2","路由守卫是什么"],["p","如果你使用过 vue-router 的话，应该对其导航守卫不陌生，能够在每次路由跳转之前做一些事情;"],["p","在 react 当中，不管使用 next/router 还是 react-router ， ysol 的路由守卫 - RouterGuard 都能在路由跳转前做一些处理 。"],["h2","使用路由守卫的场景"],["p","比如我们需要在离开当前页面的时候，做出一些提示或者动作，根据用户的行为来决定要不要进行页面的跳转;"],["p","假设有一个注销的操作，注销完了需要回到登录页; 点击注销出现弹窗提示确认或者取消;"],["p","这时就需要路由守卫了，在用户点击确认我们才进行注销操作; 点击取消就当无事发生。"],["h2","RouterGuard 的基础用法"],["ol",["li",["p","声明新的 RouterGuard 实例；"]],["li",["p","使用 beforePushState 方法，处理我们路由跳转前的逻辑，next 方法被调用才进行路由的跳转；"]],["li",["p","RouterGuard.push 进行路由跳转。"]]]],meta:{order:0,title:"RouterGuard",filename:"components/router-guard/demo/basic.md",id:"components-router-guard-demo-basic"},toc:["ul",["li",["a",{className:"bisheng-toc-h2",href:"#路由守卫是什么",title:"路由守卫是什么"},"路由守卫是什么"]],["li",["a",{className:"bisheng-toc-h2",href:"#使用路由守卫的场景",title:"使用路由守卫的场景"},"使用路由守卫的场景"]],["li",["a",{className:"bisheng-toc-h2",href:"#RouterGuard-的基础用法",title:"RouterGuard 的基础用法"},"RouterGuard 的基础用法"]]],highlightedCode:["pre",{lang:"jsx",highlighted:'<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Modal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"antd"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">"@/components/Basic/Button"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> RouterGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"ysol"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Component <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> browserHistory <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">{</span> routerGuard<span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n\n  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment" spellcheck="true">// react-router 的用法</span>\n    <span class="token keyword">const</span> routerGuard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RouterGuard</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      router<span class="token punctuation">:</span> browserHistory<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment" spellcheck="true">// 路由跳转前的处理</span>\n    routerGuard<span class="token punctuation">.</span><span class="token function">beforePushState</span><span class="token punctuation">(</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n      Modal<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        title<span class="token punctuation">:</span> <span class="token string">"确定离开当前页面吗"</span><span class="token punctuation">,</span>\n        onOk<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        onCancel<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        okText<span class="token punctuation">:</span> <span class="token string">"确定"</span><span class="token punctuation">,</span>\n        cancelText<span class="token punctuation">:</span> <span class="token string">"取消"</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Router<span class="token punctuation">.</span>routerGuard <span class="token operator">=</span> routerGuard<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> handleClick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    Router<span class="token punctuation">.</span>routerGuard<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      pathname<span class="token punctuation">:</span> <span class="token string">"/docs/introduce"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>Quick Start<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Component</span><span class="token punctuation">></span></span><span class="token punctuation">,</span> mountNode<span class="token punctuation">)</span><span class="token punctuation">;</span>'}],highlightedCodes:{jsx:'<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Modal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"antd"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">"@/components/Basic/Button"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> RouterGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"ysol"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Component</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> browserHistory <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">routerGuard</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n\n  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// react-router 的用法</span>\n    <span class="token keyword">const</span> routerGuard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RouterGuard</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token literal-property property">router</span><span class="token operator">:</span> browserHistory<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 路由跳转前的处理</span>\n    routerGuard<span class="token punctuation">.</span><span class="token function">beforePushState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      Modal<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"确定离开当前页面吗"</span><span class="token punctuation">,</span>\n        <span class="token function-variable function">onOk</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token function-variable function">onCancel</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">okText</span><span class="token operator">:</span> <span class="token string">"确定"</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">cancelText</span><span class="token operator">:</span> <span class="token string">"取消"</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Router<span class="token punctuation">.</span>routerGuard <span class="token operator">=</span> routerGuard<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    Router<span class="token punctuation">.</span>routerGuard<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">"/docs/introduce"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>Quick Start<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Component</span></span><span class="token punctuation">></span></span><span class="token punctuation">,</span> mountNode<span class="token punctuation">)</span><span class="token punctuation">;</span>'},preview:function(){a(0),a(6);function n(s){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(s)}var s,t=function(s,a){if(!a&&s&&s.__esModule)return s;if(null===s||"object"!==n(s)&&"function"!=typeof s)return{default:s};var t=e(a);if(t&&t.has(s))return t.get(s);var p={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in s)if("default"!==c&&Object.prototype.hasOwnProperty.call(s,c)){var u=o?Object.getOwnPropertyDescriptor(s,c):null;u&&(u.get||u.set)?Object.defineProperty(p,c,u):p[c]=s[c]}p.default=s,t&&t.set(s,p);return p}(a(0)),p=a(168),o=(s=a(91))&&s.__esModule?s:{default:s},c=a(903);function e(n){if("function"!=typeof WeakMap)return null;var s=new WeakMap,a=new WeakMap;return(e=function(n){return n?a:s})(n)}var u=function(n){var s=n.browserHistory,a=(0,t.useRef)({routerGuard:null}).current;(0,t.useEffect)((function(){var n=new c.RouterGuard({router:s});n.beforePushState((function(n,s){p.Modal.confirm({title:"确定离开当前页面吗",onOk:function(){s()},onCancel:function(){},okText:"确定",cancelText:"取消"})})),a.routerGuard=n}),[]);return t.default.createElement(o.default,{onClick:function(){a.routerGuard.push({pathname:"/docs/introduce"})}},"Quick Start")};return t.default.createElement(u,null)}}},884:function(n,s,a){n.exports={basic:a(1418)}}}]);